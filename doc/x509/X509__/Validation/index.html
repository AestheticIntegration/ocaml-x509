<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"><head><title>Validation (x509.X509__.Validation)</title><link rel="stylesheet" href="../../../odoc.css"/><meta charset="utf-8"/><meta name="generator" content="odoc %%VERSION%%"/><meta name="viewport" content="width=device-width,initial-scale=1.0"/><script src="../../../highlight.pack.js"></script><script>hljs.initHighlightingOnLoad();</script></head><body><div class="content"><header><nav><a href="../index.html">Up</a> â€“ <a href="../../index.html">x509</a> &#x00BB; <a href="../index.html">X509__</a> &#x00BB; Validation</nav><h1>Module <code>X509__.Validation</code></h1></header><dl><dt class="spec value" id="val-sha2"><a href="#val-sha2" class="anchor"></a><code><span class="keyword">val</span> sha2 : <span><span>[&gt; `SHA256 <span>| `SHA384</span> <span>| `SHA512</span> ]</span> list</span></code></dt><dt class="spec value" id="val-all_hashes"><a href="#val-all_hashes" class="anchor"></a><code><span class="keyword">val</span> all_hashes : <span><span>[&gt; `MD5 <span>| `SHA1</span> <span>| `SHA224</span> <span>| `SHA256</span> <span>| `SHA384</span> <span>| `SHA512</span> ]</span> list</span></code></dt><dt class="spec value" id="val-maybe_validate_hostname"><a href="#val-maybe_validate_hostname" class="anchor"></a><code><span class="keyword">val</span> maybe_validate_hostname : <a href="../../X509/Certificate/index.html#type-t">X509.Certificate.t</a> <span>&#45;&gt;</span> <span><span><span>[ `host ]</span> Domain_name.t</span> option</span> <span>&#45;&gt;</span> bool</code></dt><dt class="spec value" id="val-issuer_matches_subject"><a href="#val-issuer_matches_subject" class="anchor"></a><code><span class="keyword">val</span> issuer_matches_subject : <a href="../../X509/Certificate/index.html#type-t">X509.Certificate.t</a> <span>&#45;&gt;</span> <a href="../../X509/Certificate/index.html#type-t">X509.Certificate.t</a> <span>&#45;&gt;</span> bool</code></dt><dt class="spec value" id="val-is_self_signed"><a href="#val-is_self_signed" class="anchor"></a><code><span class="keyword">val</span> is_self_signed : <a href="../../X509/Certificate/index.html#type-t">X509.Certificate.t</a> <span>&#45;&gt;</span> bool</code></dt><dt class="spec value" id="val-validate_raw_signature"><a href="#val-validate_raw_signature" class="anchor"></a><code><span class="keyword">val</span> validate_raw_signature : <span><span>[&gt; `MD5 <span>| `SHA1</span> <span>| `SHA224</span> <span>| `SHA256</span> <span>| `SHA384</span> <span>| `SHA512</span> ]</span> list</span> <span>&#45;&gt;</span> Cstruct.t <span>&#45;&gt;</span> <a href="../Algorithm/index.html#type-t">X509__.Algorithm.t</a> <span>&#45;&gt;</span> Cstruct.t <span>&#45;&gt;</span> <span>[&gt; <span>`RSA of Nocrypto.Rsa.pub</span> ]</span> <span>&#45;&gt;</span> bool</code></dt><dt class="spec value" id="val-raw_cert_hack"><a href="#val-raw_cert_hack" class="anchor"></a><code><span class="keyword">val</span> raw_cert_hack : Cstruct.t <span>&#45;&gt;</span> Cstruct.t <span>&#45;&gt;</span> Cstruct.t</code></dt><dt class="spec value" id="val-validate_signature"><a href="#val-validate_signature" class="anchor"></a><code><span class="keyword">val</span> validate_signature : <span><span>[&gt; `MD5 <span>| `SHA1</span> <span>| `SHA224</span> <span>| `SHA256</span> <span>| `SHA384</span> <span>| `SHA512</span> ]</span> list</span> <span>&#45;&gt;</span> <a href="../../X509/Certificate/index.html#type-t">X509.Certificate.t</a> <span>&#45;&gt;</span> <a href="../../X509/Certificate/index.html#type-t">X509.Certificate.t</a> <span>&#45;&gt;</span> bool</code></dt><dt class="spec value" id="val-validate_time"><a href="#val-validate_time" class="anchor"></a><code><span class="keyword">val</span> validate_time : <span>Ptime.t option</span> <span>&#45;&gt;</span> <a href="../../X509/Certificate/index.html#type-t">X509.Certificate.t</a> <span>&#45;&gt;</span> bool</code></dt><dt class="spec value" id="val-version_matches_extensions"><a href="#val-version_matches_extensions" class="anchor"></a><code><span class="keyword">val</span> version_matches_extensions : <a href="../../X509/Certificate/index.html#type-t">X509.Certificate.t</a> <span>&#45;&gt;</span> bool</code></dt><dt class="spec value" id="val-validate_path_len"><a href="#val-validate_path_len" class="anchor"></a><code><span class="keyword">val</span> validate_path_len : int <span>&#45;&gt;</span> <a href="../../X509/Certificate/index.html#type-t">X509.Certificate.t</a> <span>&#45;&gt;</span> bool</code></dt><dt class="spec value" id="val-validate_ca_extensions"><a href="#val-validate_ca_extensions" class="anchor"></a><code><span class="keyword">val</span> validate_ca_extensions : <a href="../../X509/Certificate/index.html#type-t">X509.Certificate.t</a> <span>&#45;&gt;</span> bool</code></dt><dt class="spec value" id="val-validate_server_extensions"><a href="#val-validate_server_extensions" class="anchor"></a><code><span class="keyword">val</span> validate_server_extensions : <a href="../../X509/Certificate/index.html#type-t">X509.Certificate.t</a> <span>&#45;&gt;</span> bool</code></dt><dt class="spec value" id="val-valid_trust_anchor_extensions"><a href="#val-valid_trust_anchor_extensions" class="anchor"></a><code><span class="keyword">val</span> valid_trust_anchor_extensions : <a href="../../X509/Certificate/index.html#type-t">X509.Certificate.t</a> <span>&#45;&gt;</span> bool</code></dt><dt class="spec value" id="val-ext_authority_matches_subject"><a href="#val-ext_authority_matches_subject" class="anchor"></a><code><span class="keyword">val</span> ext_authority_matches_subject : <a href="../../X509/Certificate/index.html#type-t">X509.Certificate.t</a> <span>&#45;&gt;</span> <a href="../../X509/Certificate/index.html#type-t">X509.Certificate.t</a> <span>&#45;&gt;</span> bool</code></dt><dt class="spec value" id="val-build_paths"><a href="#val-build_paths" class="anchor"></a><code><span class="keyword">val</span> build_paths : <a href="../../X509/Certificate/index.html#type-t">X509.Certificate.t</a> <span>&#45;&gt;</span> <span><a href="../../X509/Certificate/index.html#type-t">X509.Certificate.t</a> list</span> <span>&#45;&gt;</span> <span><span><a href="../../X509/Certificate/index.html#type-t">X509.Certificate.t</a> list</span> list</span></code></dt></dl><dl><dt class="spec type" id="type-ca_error"><a href="#type-ca_error" class="anchor"></a><code><span class="keyword">type</span> ca_error</code> = <code>[ </code><table class="variant"><tr id="type-ca_error.CAIssuerSubjectMismatch" class="anchored"><td class="def constructor"><a href="#type-ca_error.CAIssuerSubjectMismatch" class="anchor"></a><code>| </code><code>`CAIssuerSubjectMismatch <span class="keyword">of</span> <a href="../../X509/Certificate/index.html#type-t">X509.Certificate.t</a></code></td></tr><tr id="type-ca_error.CAInvalidVersion" class="anchored"><td class="def constructor"><a href="#type-ca_error.CAInvalidVersion" class="anchor"></a><code>| </code><code>`CAInvalidVersion <span class="keyword">of</span> <a href="../../X509/Certificate/index.html#type-t">X509.Certificate.t</a></code></td></tr><tr id="type-ca_error.CAInvalidSelfSignature" class="anchored"><td class="def constructor"><a href="#type-ca_error.CAInvalidSelfSignature" class="anchor"></a><code>| </code><code>`CAInvalidSelfSignature <span class="keyword">of</span> <a href="../../X509/Certificate/index.html#type-t">X509.Certificate.t</a></code></td></tr><tr id="type-ca_error.CACertificateExpired" class="anchored"><td class="def constructor"><a href="#type-ca_error.CACertificateExpired" class="anchor"></a><code>| </code><code>`CACertificateExpired <span class="keyword">of</span> <a href="../../X509/Certificate/index.html#type-t">X509.Certificate.t</a> * <span>Ptime.t option</span></code></td></tr><tr id="type-ca_error.CAInvalidExtensions" class="anchored"><td class="def constructor"><a href="#type-ca_error.CAInvalidExtensions" class="anchor"></a><code>| </code><code>`CAInvalidExtensions <span class="keyword">of</span> <a href="../../X509/Certificate/index.html#type-t">X509.Certificate.t</a></code></td></tr></table><code> ]</code></dt></dl><dl><dt class="spec value" id="val-pp_ca_error"><a href="#val-pp_ca_error" class="anchor"></a><code><span class="keyword">val</span> pp_ca_error : Stdlib.Format.formatter <span>&#45;&gt;</span> <span>[&lt; <span>`CACertificateExpired of <a href="../../X509/Certificate/index.html#type-t">X509.Certificate.t</a> * <span>Ptime.t option</span></span> <span><span>| `CAInvalidExtensions</span> of <a href="../../X509/Certificate/index.html#type-t">X509.Certificate.t</a></span> <span><span>| `CAInvalidSelfSignature</span> of <a href="../../X509/Certificate/index.html#type-t">X509.Certificate.t</a></span> <span><span>| `CAInvalidVersion</span> of <a href="../../X509/Certificate/index.html#type-t">X509.Certificate.t</a></span> <span><span>| `CAIssuerSubjectMismatch</span> of <a href="../../X509/Certificate/index.html#type-t">X509.Certificate.t</a></span> ]</span> <span>&#45;&gt;</span> unit</code></dt></dl><dl><dt class="spec type" id="type-leaf_validation_error"><a href="#type-leaf_validation_error" class="anchor"></a><code><span class="keyword">type</span> leaf_validation_error</code> = <code>[ </code><table class="variant"><tr id="type-leaf_validation_error.LeafCertificateExpired" class="anchored"><td class="def constructor"><a href="#type-leaf_validation_error.LeafCertificateExpired" class="anchor"></a><code>| </code><code>`LeafCertificateExpired <span class="keyword">of</span> <a href="../../X509/Certificate/index.html#type-t">X509.Certificate.t</a> * <span>Ptime.t option</span></code></td></tr><tr id="type-leaf_validation_error.LeafInvalidName" class="anchored"><td class="def constructor"><a href="#type-leaf_validation_error.LeafInvalidName" class="anchor"></a><code>| </code><code>`LeafInvalidName <span class="keyword">of</span> <a href="../../X509/Certificate/index.html#type-t">X509.Certificate.t</a> * <span><span><span>[ `host ]</span> Domain_name.t</span> option</span></code></td></tr><tr id="type-leaf_validation_error.LeafInvalidVersion" class="anchored"><td class="def constructor"><a href="#type-leaf_validation_error.LeafInvalidVersion" class="anchor"></a><code>| </code><code>`LeafInvalidVersion <span class="keyword">of</span> <a href="../../X509/Certificate/index.html#type-t">X509.Certificate.t</a></code></td></tr><tr id="type-leaf_validation_error.LeafInvalidExtensions" class="anchored"><td class="def constructor"><a href="#type-leaf_validation_error.LeafInvalidExtensions" class="anchor"></a><code>| </code><code>`LeafInvalidExtensions <span class="keyword">of</span> <a href="../../X509/Certificate/index.html#type-t">X509.Certificate.t</a></code></td></tr></table><code> ]</code></dt></dl><dl><dt class="spec value" id="val-pp_leaf_validation_error"><a href="#val-pp_leaf_validation_error" class="anchor"></a><code><span class="keyword">val</span> pp_leaf_validation_error : Stdlib.Format.formatter <span>&#45;&gt;</span> <span>[&lt; <span>`LeafCertificateExpired of <a href="../../X509/Certificate/index.html#type-t">X509.Certificate.t</a> * <span>Ptime.t option</span></span> <span><span>| `LeafInvalidExtensions</span> of <a href="../../X509/Certificate/index.html#type-t">X509.Certificate.t</a></span> <span><span>| `LeafInvalidName</span> of <a href="../../X509/Certificate/index.html#type-t">X509.Certificate.t</a> * <span><span><span class="type-var">'a</span> Domain_name.t</span> option</span></span> <span><span>| `LeafInvalidVersion</span> of <a href="../../X509/Certificate/index.html#type-t">X509.Certificate.t</a></span> ]</span> <span>&#45;&gt;</span> unit</code></dt></dl><dl><dt class="spec type" id="type-chain_validation_error"><a href="#type-chain_validation_error" class="anchor"></a><code><span class="keyword">type</span> chain_validation_error</code> = <code>[ </code><table class="variant"><tr id="type-chain_validation_error.IntermediateInvalidExtensions" class="anchored"><td class="def constructor"><a href="#type-chain_validation_error.IntermediateInvalidExtensions" class="anchor"></a><code>| </code><code>`IntermediateInvalidExtensions <span class="keyword">of</span> <a href="../../X509/Certificate/index.html#type-t">X509.Certificate.t</a></code></td></tr><tr id="type-chain_validation_error.IntermediateCertificateExpired" class="anchored"><td class="def constructor"><a href="#type-chain_validation_error.IntermediateCertificateExpired" class="anchor"></a><code>| </code><code>`IntermediateCertificateExpired <span class="keyword">of</span> <a href="../../X509/Certificate/index.html#type-t">X509.Certificate.t</a> * <span>Ptime.t option</span></code></td></tr><tr id="type-chain_validation_error.IntermediateInvalidVersion" class="anchored"><td class="def constructor"><a href="#type-chain_validation_error.IntermediateInvalidVersion" class="anchor"></a><code>| </code><code>`IntermediateInvalidVersion <span class="keyword">of</span> <a href="../../X509/Certificate/index.html#type-t">X509.Certificate.t</a></code></td></tr><tr id="type-chain_validation_error.ChainIssuerSubjectMismatch" class="anchored"><td class="def constructor"><a href="#type-chain_validation_error.ChainIssuerSubjectMismatch" class="anchor"></a><code>| </code><code>`ChainIssuerSubjectMismatch <span class="keyword">of</span> <a href="../../X509/Certificate/index.html#type-t">X509.Certificate.t</a> * <a href="../../X509/Certificate/index.html#type-t">X509.Certificate.t</a></code></td></tr><tr id="type-chain_validation_error.ChainAuthorityKeyIdSubjectKeyIdMismatch" class="anchored"><td class="def constructor"><a href="#type-chain_validation_error.ChainAuthorityKeyIdSubjectKeyIdMismatch" class="anchor"></a><code>| </code><code>`ChainAuthorityKeyIdSubjectKeyIdMismatch <span class="keyword">of</span> <a href="../../X509/Certificate/index.html#type-t">X509.Certificate.t</a> * <a href="../../X509/Certificate/index.html#type-t">X509.Certificate.t</a></code></td></tr><tr id="type-chain_validation_error.ChainInvalidSignature" class="anchored"><td class="def constructor"><a href="#type-chain_validation_error.ChainInvalidSignature" class="anchor"></a><code>| </code><code>`ChainInvalidSignature <span class="keyword">of</span> <a href="../../X509/Certificate/index.html#type-t">X509.Certificate.t</a> * <a href="../../X509/Certificate/index.html#type-t">X509.Certificate.t</a></code></td></tr><tr id="type-chain_validation_error.ChainInvalidPathlen" class="anchored"><td class="def constructor"><a href="#type-chain_validation_error.ChainInvalidPathlen" class="anchor"></a><code>| </code><code>`ChainInvalidPathlen <span class="keyword">of</span> <a href="../../X509/Certificate/index.html#type-t">X509.Certificate.t</a> * int</code></td></tr><tr id="type-chain_validation_error.EmptyCertificateChain" class="anchored"><td class="def constructor"><a href="#type-chain_validation_error.EmptyCertificateChain" class="anchor"></a><code>| </code><code>`EmptyCertificateChain</code></td></tr><tr id="type-chain_validation_error.NoTrustAnchor" class="anchored"><td class="def constructor"><a href="#type-chain_validation_error.NoTrustAnchor" class="anchor"></a><code>| </code><code>`NoTrustAnchor <span class="keyword">of</span> <a href="../../X509/Certificate/index.html#type-t">X509.Certificate.t</a></code></td></tr><tr id="type-chain_validation_error.Revoked" class="anchored"><td class="def constructor"><a href="#type-chain_validation_error.Revoked" class="anchor"></a><code>| </code><code>`Revoked <span class="keyword">of</span> <a href="../../X509/Certificate/index.html#type-t">X509.Certificate.t</a></code></td></tr></table><code> ]</code></dt></dl><dl><dt class="spec value" id="val-pp_chain_validation_error"><a href="#val-pp_chain_validation_error" class="anchor"></a><code><span class="keyword">val</span> pp_chain_validation_error : Stdlib.Format.formatter <span>&#45;&gt;</span> <span>[&lt; <span>`ChainAuthorityKeyIdSubjectKeyIdMismatch of <a href="../../X509/Certificate/index.html#type-t">X509.Certificate.t</a> * <a href="../../X509/Certificate/index.html#type-t">X509.Certificate.t</a></span> <span><span>| `ChainInvalidPathlen</span> of <a href="../../X509/Certificate/index.html#type-t">X509.Certificate.t</a> * int</span> <span><span>| `ChainInvalidSignature</span> of <a href="../../X509/Certificate/index.html#type-t">X509.Certificate.t</a> * <a href="../../X509/Certificate/index.html#type-t">X509.Certificate.t</a></span> <span><span>| `ChainIssuerSubjectMismatch</span> of <a href="../../X509/Certificate/index.html#type-t">X509.Certificate.t</a> * <a href="../../X509/Certificate/index.html#type-t">X509.Certificate.t</a></span> <span>| `EmptyCertificateChain</span> <span><span>| `IntermediateCertificateExpired</span> of <a href="../../X509/Certificate/index.html#type-t">X509.Certificate.t</a> * <span>Ptime.t option</span></span> <span><span>| `IntermediateInvalidExtensions</span> of <a href="../../X509/Certificate/index.html#type-t">X509.Certificate.t</a></span> <span><span>| `IntermediateInvalidVersion</span> of <a href="../../X509/Certificate/index.html#type-t">X509.Certificate.t</a></span> <span><span>| `NoTrustAnchor</span> of <a href="../../X509/Certificate/index.html#type-t">X509.Certificate.t</a></span> <span><span>| `Revoked</span> of <a href="../../X509/Certificate/index.html#type-t">X509.Certificate.t</a></span> ]</span> <span>&#45;&gt;</span> unit</code></dt></dl><dl><dt class="spec type" id="type-chain_error"><a href="#type-chain_error" class="anchor"></a><code><span class="keyword">type</span> chain_error</code> = <code>[ </code><table class="variant"><tr id="type-chain_error.Leaf" class="anchored"><td class="def constructor"><a href="#type-chain_error.Leaf" class="anchor"></a><code>| </code><code>`Leaf <span class="keyword">of</span> <a href="index.html#type-leaf_validation_error">leaf_validation_error</a></code></td></tr><tr id="type-chain_error.Chain" class="anchored"><td class="def constructor"><a href="#type-chain_error.Chain" class="anchor"></a><code>| </code><code>`Chain <span class="keyword">of</span> <a href="index.html#type-chain_validation_error">chain_validation_error</a></code></td></tr></table><code> ]</code></dt></dl><dl><dt class="spec value" id="val-pp_chain_error"><a href="#val-pp_chain_error" class="anchor"></a><code><span class="keyword">val</span> pp_chain_error : Stdlib.Format.formatter <span>&#45;&gt;</span> <span>[&lt; <span>`Chain of <span>[&lt; <span>`ChainAuthorityKeyIdSubjectKeyIdMismatch of <a href="../../X509/Certificate/index.html#type-t">X509.Certificate.t</a> * <a href="../../X509/Certificate/index.html#type-t">X509.Certificate.t</a></span> <span><span>| `ChainInvalidPathlen</span> of <a href="../../X509/Certificate/index.html#type-t">X509.Certificate.t</a> * int</span> <span><span>| `ChainInvalidSignature</span> of <a href="../../X509/Certificate/index.html#type-t">X509.Certificate.t</a> * <a href="../../X509/Certificate/index.html#type-t">X509.Certificate.t</a></span> <span><span>| `ChainIssuerSubjectMismatch</span> of <a href="../../X509/Certificate/index.html#type-t">X509.Certificate.t</a> * <a href="../../X509/Certificate/index.html#type-t">X509.Certificate.t</a></span> <span>| `EmptyCertificateChain</span> <span><span>| `IntermediateCertificateExpired</span> of <a href="../../X509/Certificate/index.html#type-t">X509.Certificate.t</a> * <span>Ptime.t option</span></span> <span><span>| `IntermediateInvalidExtensions</span> of <a href="../../X509/Certificate/index.html#type-t">X509.Certificate.t</a></span> <span><span>| `IntermediateInvalidVersion</span> of <a href="../../X509/Certificate/index.html#type-t">X509.Certificate.t</a></span> <span><span>| `NoTrustAnchor</span> of <a href="../../X509/Certificate/index.html#type-t">X509.Certificate.t</a></span> <span><span>| `Revoked</span> of <a href="../../X509/Certificate/index.html#type-t">X509.Certificate.t</a></span> ]</span></span> <span><span>| `Leaf</span> of <span>[&lt; <span>`LeafCertificateExpired of <a href="../../X509/Certificate/index.html#type-t">X509.Certificate.t</a> * <span>Ptime.t option</span></span> <span><span>| `LeafInvalidExtensions</span> of <a href="../../X509/Certificate/index.html#type-t">X509.Certificate.t</a></span> <span><span>| `LeafInvalidName</span> of <a href="../../X509/Certificate/index.html#type-t">X509.Certificate.t</a> * <span><span><span class="type-var">'a</span> Domain_name.t</span> option</span></span> <span><span>| `LeafInvalidVersion</span> of <a href="../../X509/Certificate/index.html#type-t">X509.Certificate.t</a></span> ]</span></span> ]</span> <span>&#45;&gt;</span> unit</code></dt></dl><dl><dt class="spec type" id="type-fingerprint_validation_error"><a href="#type-fingerprint_validation_error" class="anchor"></a><code><span class="keyword">type</span> fingerprint_validation_error</code> = <code>[ </code><table class="variant"><tr id="type-fingerprint_validation_error.ServerNameNotPresent" class="anchored"><td class="def constructor"><a href="#type-fingerprint_validation_error.ServerNameNotPresent" class="anchor"></a><code>| </code><code>`ServerNameNotPresent <span class="keyword">of</span> <a href="../../X509/Certificate/index.html#type-t">X509.Certificate.t</a> * <span><span>[ `host ]</span> Domain_name.t</span></code></td></tr><tr id="type-fingerprint_validation_error.NameNotInList" class="anchored"><td class="def constructor"><a href="#type-fingerprint_validation_error.NameNotInList" class="anchor"></a><code>| </code><code>`NameNotInList <span class="keyword">of</span> <a href="../../X509/Certificate/index.html#type-t">X509.Certificate.t</a></code></td></tr><tr id="type-fingerprint_validation_error.InvalidFingerprint" class="anchored"><td class="def constructor"><a href="#type-fingerprint_validation_error.InvalidFingerprint" class="anchor"></a><code>| </code><code>`InvalidFingerprint <span class="keyword">of</span> <a href="../../X509/Certificate/index.html#type-t">X509.Certificate.t</a> * Cstruct.t * Cstruct.t</code></td></tr></table><code> ]</code></dt></dl><dl><dt class="spec value" id="val-pp_fingerprint_validation_error"><a href="#val-pp_fingerprint_validation_error" class="anchor"></a><code><span class="keyword">val</span> pp_fingerprint_validation_error : Stdlib.Format.formatter <span>&#45;&gt;</span> <span>[&lt; <span>`InvalidFingerprint of <a href="../../X509/Certificate/index.html#type-t">X509.Certificate.t</a> * Cstruct.t * Cstruct.t</span> <span><span>| `NameNotInList</span> of <a href="../../X509/Certificate/index.html#type-t">X509.Certificate.t</a></span> <span><span>| `ServerNameNotPresent</span> of <a href="../../X509/Certificate/index.html#type-t">X509.Certificate.t</a> * <span><span class="type-var">'a</span> Domain_name.t</span></span> ]</span> <span>&#45;&gt;</span> unit</code></dt></dl><dl><dt class="spec type" id="type-validation_error"><a href="#type-validation_error" class="anchor"></a><code><span class="keyword">type</span> validation_error</code> = <code>[ </code><table class="variant"><tr id="type-validation_error.EmptyCertificateChain" class="anchored"><td class="def constructor"><a href="#type-validation_error.EmptyCertificateChain" class="anchor"></a><code>| </code><code>`EmptyCertificateChain</code></td></tr><tr id="type-validation_error.InvalidChain" class="anchored"><td class="def constructor"><a href="#type-validation_error.InvalidChain" class="anchor"></a><code>| </code><code>`InvalidChain</code></td></tr><tr id="type-validation_error.Leaf" class="anchored"><td class="def constructor"><a href="#type-validation_error.Leaf" class="anchor"></a><code>| </code><code>`Leaf <span class="keyword">of</span> <a href="index.html#type-leaf_validation_error">leaf_validation_error</a></code></td></tr><tr id="type-validation_error.Fingerprint" class="anchored"><td class="def constructor"><a href="#type-validation_error.Fingerprint" class="anchor"></a><code>| </code><code>`Fingerprint <span class="keyword">of</span> <a href="index.html#type-fingerprint_validation_error">fingerprint_validation_error</a></code></td></tr></table><code> ]</code></dt></dl><dl><dt class="spec value" id="val-pp_validation_error"><a href="#val-pp_validation_error" class="anchor"></a><code><span class="keyword">val</span> pp_validation_error : Stdlib.Format.formatter <span>&#45;&gt;</span> <span>[&lt; `EmptyCertificateChain <span><span>| `Fingerprint</span> of <span>[&lt; <span>`InvalidFingerprint of <a href="../../X509/Certificate/index.html#type-t">X509.Certificate.t</a> * Cstruct.t * Cstruct.t</span> <span><span>| `NameNotInList</span> of <a href="../../X509/Certificate/index.html#type-t">X509.Certificate.t</a></span> <span><span>| `ServerNameNotPresent</span> of <a href="../../X509/Certificate/index.html#type-t">X509.Certificate.t</a> * <span><span class="type-var">'a</span> Domain_name.t</span></span> ]</span></span> <span>| `InvalidChain</span> <span><span>| `Leaf</span> of <span>[&lt; <span>`LeafCertificateExpired of <a href="../../X509/Certificate/index.html#type-t">X509.Certificate.t</a> * <span>Ptime.t option</span></span> <span><span>| `LeafInvalidExtensions</span> of <a href="../../X509/Certificate/index.html#type-t">X509.Certificate.t</a></span> <span><span>| `LeafInvalidName</span> of <a href="../../X509/Certificate/index.html#type-t">X509.Certificate.t</a> * <span><span><span class="type-var">'b</span> Domain_name.t</span> option</span></span> <span><span>| `LeafInvalidVersion</span> of <a href="../../X509/Certificate/index.html#type-t">X509.Certificate.t</a></span> ]</span></span> ]</span> <span>&#45;&gt;</span> unit</code></dt></dl><dl><dt class="spec type" id="type-r"><a href="#type-r" class="anchor"></a><code><span class="keyword">type</span> r</code><code> = <span><span>(<span><span>(<span><a href="../../X509/Certificate/index.html#type-t">X509.Certificate.t</a> list</span> * <a href="../../X509/Certificate/index.html#type-t">X509.Certificate.t</a>)</span> option</span>,Â <a href="index.html#type-validation_error">validation_error</a>)</span> Stdlib.result</span></code></dt></dl><dl><dt class="spec value" id="val-is_cert_valid"><a href="#val-is_cert_valid" class="anchor"></a><code><span class="keyword">val</span> is_cert_valid : <span>Ptime.t option</span> <span>&#45;&gt;</span> <a href="../../X509/Certificate/index.html#type-t">X509.Certificate.t</a> <span>&#45;&gt;</span> <span><span>(unit,Â <span>[&gt; <span>`IntermediateCertificateExpired of <a href="../../X509/Certificate/index.html#type-t">X509.Certificate.t</a> * <span>Ptime.t option</span></span> <span><span>| `IntermediateInvalidExtensions</span> of <a href="../../X509/Certificate/index.html#type-t">X509.Certificate.t</a></span> <span><span>| `IntermediateInvalidVersion</span> of <a href="../../X509/Certificate/index.html#type-t">X509.Certificate.t</a></span> ]</span>)</span> Stdlib.result</span></code></dt><dt class="spec value" id="val-is_ca_cert_valid"><a href="#val-is_ca_cert_valid" class="anchor"></a><code><span class="keyword">val</span> is_ca_cert_valid : <span><span>[&gt; `MD5 <span>| `SHA1</span> <span>| `SHA224</span> <span>| `SHA256</span> <span>| `SHA384</span> <span>| `SHA512</span> ]</span> list</span> <span>&#45;&gt;</span> <span>Ptime.t option</span> <span>&#45;&gt;</span> <a href="../../X509/Certificate/index.html#type-t">X509.Certificate.t</a> <span>&#45;&gt;</span> <span><span>(unit,Â <span>[&gt; <span>`CACertificateExpired of <a href="../../X509/Certificate/index.html#type-t">X509.Certificate.t</a> * <span>Ptime.t option</span></span> <span><span>| `CAInvalidExtensions</span> of <a href="../../X509/Certificate/index.html#type-t">X509.Certificate.t</a></span> <span><span>| `CAInvalidSelfSignature</span> of <a href="../../X509/Certificate/index.html#type-t">X509.Certificate.t</a></span> <span><span>| `CAInvalidVersion</span> of <a href="../../X509/Certificate/index.html#type-t">X509.Certificate.t</a></span> <span><span>| `CAIssuerSubjectMismatch</span> of <a href="../../X509/Certificate/index.html#type-t">X509.Certificate.t</a></span> ]</span>)</span> Stdlib.result</span></code></dt><dt class="spec value" id="val-valid_ca"><a href="#val-valid_ca" class="anchor"></a><code><span class="keyword">val</span> valid_ca : <span>?&#8288;hash_whitelist:<span><span>[&gt; `MD5 <span>| `SHA1</span> <span>| `SHA224</span> <span>| `SHA256</span> <span>| `SHA384</span> <span>| `SHA512</span> ]</span> list</span></span> <span>&#45;&gt;</span> <span>?&#8288;time:Ptime.t</span> <span>&#45;&gt;</span> <a href="../../X509/Certificate/index.html#type-t">X509.Certificate.t</a> <span>&#45;&gt;</span> <span><span>(unit,Â <span>[&gt; <span>`CACertificateExpired of <a href="../../X509/Certificate/index.html#type-t">X509.Certificate.t</a> * <span>Ptime.t option</span></span> <span><span>| `CAInvalidExtensions</span> of <a href="../../X509/Certificate/index.html#type-t">X509.Certificate.t</a></span> <span><span>| `CAInvalidSelfSignature</span> of <a href="../../X509/Certificate/index.html#type-t">X509.Certificate.t</a></span> <span><span>| `CAInvalidVersion</span> of <a href="../../X509/Certificate/index.html#type-t">X509.Certificate.t</a></span> <span><span>| `CAIssuerSubjectMismatch</span> of <a href="../../X509/Certificate/index.html#type-t">X509.Certificate.t</a></span> ]</span>)</span> Stdlib.result</span></code></dt><dt class="spec value" id="val-is_server_cert_valid"><a href="#val-is_server_cert_valid" class="anchor"></a><code><span class="keyword">val</span> is_server_cert_valid : <span>?&#8288;host:<span><span>[ `host ]</span> Domain_name.t</span></span> <span>&#45;&gt;</span> <span>Ptime.t option</span> <span>&#45;&gt;</span> <a href="../../X509/Certificate/index.html#type-t">X509.Certificate.t</a> <span>&#45;&gt;</span> <span><span>(unit,Â <span>[&gt; <span>`LeafCertificateExpired of <a href="../../X509/Certificate/index.html#type-t">X509.Certificate.t</a> * <span>Ptime.t option</span></span> <span><span>| `LeafInvalidExtensions</span> of <a href="../../X509/Certificate/index.html#type-t">X509.Certificate.t</a></span> <span><span>| `LeafInvalidName</span> of <a href="../../X509/Certificate/index.html#type-t">X509.Certificate.t</a> * <span><span><span>[ `host ]</span> Domain_name.t</span> option</span></span> <span><span>| `LeafInvalidVersion</span> of <a href="../../X509/Certificate/index.html#type-t">X509.Certificate.t</a></span> ]</span>)</span> Stdlib.result</span></code></dt><dt class="spec value" id="val-signs"><a href="#val-signs" class="anchor"></a><code><span class="keyword">val</span> signs : <span><span>[&gt; `MD5 <span>| `SHA1</span> <span>| `SHA224</span> <span>| `SHA256</span> <span>| `SHA384</span> <span>| `SHA512</span> ]</span> list</span> <span>&#45;&gt;</span> int <span>&#45;&gt;</span> <a href="../../X509/Certificate/index.html#type-t">X509.Certificate.t</a> <span>&#45;&gt;</span> <a href="../../X509/Certificate/index.html#type-t">X509.Certificate.t</a> <span>&#45;&gt;</span> <span><span>(unit,Â <span>[&gt; <span>`ChainAuthorityKeyIdSubjectKeyIdMismatch of <a href="../../X509/Certificate/index.html#type-t">X509.Certificate.t</a> * <a href="../../X509/Certificate/index.html#type-t">X509.Certificate.t</a></span> <span><span>| `ChainInvalidPathlen</span> of <a href="../../X509/Certificate/index.html#type-t">X509.Certificate.t</a> * int</span> <span><span>| `ChainInvalidSignature</span> of <a href="../../X509/Certificate/index.html#type-t">X509.Certificate.t</a> * <a href="../../X509/Certificate/index.html#type-t">X509.Certificate.t</a></span> <span><span>| `ChainIssuerSubjectMismatch</span> of <a href="../../X509/Certificate/index.html#type-t">X509.Certificate.t</a> * <a href="../../X509/Certificate/index.html#type-t">X509.Certificate.t</a></span> ]</span>)</span> Stdlib.result</span></code></dt><dt class="spec value" id="val-issuer"><a href="#val-issuer" class="anchor"></a><code><span class="keyword">val</span> issuer : <span><a href="../../X509/Certificate/index.html#type-t">X509.Certificate.t</a> list</span> <span>&#45;&gt;</span> <a href="../../X509/Certificate/index.html#type-t">X509.Certificate.t</a> <span>&#45;&gt;</span> <span><a href="../../X509/Certificate/index.html#type-t">X509.Certificate.t</a> list</span></code></dt><dt class="spec value" id="val-validate_anchors"><a href="#val-validate_anchors" class="anchor"></a><code><span class="keyword">val</span> validate_anchors : <span>(<span>issuer:<a href="../../X509/Certificate/index.html#type-t">X509.Certificate.t</a></span> <span>&#45;&gt;</span> <span>cert:<a href="../../X509/Certificate/index.html#type-t">X509.Certificate.t</a></span> <span>&#45;&gt;</span> bool)</span> <span>&#45;&gt;</span> <span><span>[&gt; `MD5 <span>| `SHA1</span> <span>| `SHA224</span> <span>| `SHA256</span> <span>| `SHA384</span> <span>| `SHA512</span> ]</span> list</span> <span>&#45;&gt;</span> int <span>&#45;&gt;</span> <a href="../../X509/Certificate/index.html#type-t">X509.Certificate.t</a> <span>&#45;&gt;</span> <span><a href="../../X509/Certificate/index.html#type-t">X509.Certificate.t</a> list</span> <span>&#45;&gt;</span> <span><span>(<a href="../../X509/Certificate/index.html#type-t">X509.Certificate.t</a>,Â <span>[&gt; <span>`NoTrustAnchor of <a href="../../X509/Certificate/index.html#type-t">X509.Certificate.t</a></span> <span><span>| `Revoked</span> of <a href="../../X509/Certificate/index.html#type-t">X509.Certificate.t</a></span> ]</span>)</span> Stdlib.result</span></code></dt><dt class="spec value" id="val-lift_leaf"><a href="#val-lift_leaf" class="anchor"></a><code><span class="keyword">val</span> lift_leaf : <span>(<span class="type-var">'a</span> <span>&#45;&gt;</span> <span><span>(unit,Â <span class="type-var">'b</span>)</span> Stdlib.result</span>)</span> <span>&#45;&gt;</span> <span class="type-var">'a</span> <span>&#45;&gt;</span> <span><span>(unit,Â <span>[&gt; <span>`Leaf of <span class="type-var">'b</span></span> ]</span>)</span> Stdlib.result</span></code></dt><dt class="spec value" id="val-verify_single_chain"><a href="#val-verify_single_chain" class="anchor"></a><code><span class="keyword">val</span> verify_single_chain : <span>?&#8288;time:Ptime.t</span> <span>&#45;&gt;</span> <span>?&#8288;revoked:<span>(<span>issuer:<a href="../../X509/Certificate/index.html#type-t">X509.Certificate.t</a></span> <span>&#45;&gt;</span> <span>cert:<a href="../../X509/Certificate/index.html#type-t">X509.Certificate.t</a></span> <span>&#45;&gt;</span> bool)</span></span> <span>&#45;&gt;</span> <span><span>[&gt; `MD5 <span>| `SHA1</span> <span>| `SHA224</span> <span>| `SHA256</span> <span>| `SHA384</span> <span>| `SHA512</span> ]</span> list</span> <span>&#45;&gt;</span> <span><a href="../../X509/Certificate/index.html#type-t">X509.Certificate.t</a> list</span> <span>&#45;&gt;</span> <span><a href="../../X509/Certificate/index.html#type-t">X509.Certificate.t</a> list</span> <span>&#45;&gt;</span> <span><span>(<a href="../../X509/Certificate/index.html#type-t">X509.Certificate.t</a>,Â <span>[&gt; <span>`ChainAuthorityKeyIdSubjectKeyIdMismatch of <a href="../../X509/Certificate/index.html#type-t">X509.Certificate.t</a> * <a href="../../X509/Certificate/index.html#type-t">X509.Certificate.t</a></span> <span><span>| `ChainInvalidPathlen</span> of <a href="../../X509/Certificate/index.html#type-t">X509.Certificate.t</a> * int</span> <span><span>| `ChainInvalidSignature</span> of <a href="../../X509/Certificate/index.html#type-t">X509.Certificate.t</a> * <a href="../../X509/Certificate/index.html#type-t">X509.Certificate.t</a></span> <span><span>| `ChainIssuerSubjectMismatch</span> of <a href="../../X509/Certificate/index.html#type-t">X509.Certificate.t</a> * <a href="../../X509/Certificate/index.html#type-t">X509.Certificate.t</a></span> <span>| `EmptyCertificateChain</span> <span><span>| `IntermediateCertificateExpired</span> of <a href="../../X509/Certificate/index.html#type-t">X509.Certificate.t</a> * <span>Ptime.t option</span></span> <span><span>| `IntermediateInvalidExtensions</span> of <a href="../../X509/Certificate/index.html#type-t">X509.Certificate.t</a></span> <span><span>| `IntermediateInvalidVersion</span> of <a href="../../X509/Certificate/index.html#type-t">X509.Certificate.t</a></span> <span><span>| `NoTrustAnchor</span> of <a href="../../X509/Certificate/index.html#type-t">X509.Certificate.t</a></span> <span><span>| `Revoked</span> of <a href="../../X509/Certificate/index.html#type-t">X509.Certificate.t</a></span> ]</span>)</span> Result.result</span></code></dt><dt class="spec value" id="val-lift_chain"><a href="#val-lift_chain" class="anchor"></a><code><span class="keyword">val</span> lift_chain : <span>(<span class="type-var">'a</span> <span>&#45;&gt;</span> <span><span>(<span class="type-var">'b</span>,Â <span class="type-var">'c</span>)</span> Stdlib.result</span>)</span> <span>&#45;&gt;</span> <span class="type-var">'a</span> <span>&#45;&gt;</span> <span><span>(<span class="type-var">'b</span>,Â <span>[&gt; <span>`Chain of <span class="type-var">'c</span></span> ]</span>)</span> Stdlib.result</span></code></dt><dt class="spec value" id="val-verify_chain"><a href="#val-verify_chain" class="anchor"></a><code><span class="keyword">val</span> verify_chain : <span>?&#8288;host:<span><span>[ `host ]</span> Domain_name.t</span></span> <span>&#45;&gt;</span> <span>?&#8288;time:Ptime.t</span> <span>&#45;&gt;</span> <span>?&#8288;revoked:<span>(<span>issuer:<a href="../../X509/Certificate/index.html#type-t">X509.Certificate.t</a></span> <span>&#45;&gt;</span> <span>cert:<a href="../../X509/Certificate/index.html#type-t">X509.Certificate.t</a></span> <span>&#45;&gt;</span> bool)</span></span> <span>&#45;&gt;</span> <span>?&#8288;hash_whitelist:<span><span>[&gt; `MD5 <span>| `SHA1</span> <span>| `SHA224</span> <span>| `SHA256</span> <span>| `SHA384</span> <span>| `SHA512</span> ]</span> list</span></span> <span>&#45;&gt;</span> <span>anchors:<span><a href="../../X509/Certificate/index.html#type-t">X509.Certificate.t</a> list</span></span> <span>&#45;&gt;</span> <span><a href="../../X509/Certificate/index.html#type-t">X509.Certificate.t</a> list</span> <span>&#45;&gt;</span> <span><span>(<a href="../../X509/Certificate/index.html#type-t">X509.Certificate.t</a>,Â <span>[&gt; <span>`Chain of <span>[&gt; <span>`ChainAuthorityKeyIdSubjectKeyIdMismatch of <a href="../../X509/Certificate/index.html#type-t">X509.Certificate.t</a> * <a href="../../X509/Certificate/index.html#type-t">X509.Certificate.t</a></span> <span><span>| `ChainInvalidPathlen</span> of <a href="../../X509/Certificate/index.html#type-t">X509.Certificate.t</a> * int</span> <span><span>| `ChainInvalidSignature</span> of <a href="../../X509/Certificate/index.html#type-t">X509.Certificate.t</a> * <a href="../../X509/Certificate/index.html#type-t">X509.Certificate.t</a></span> <span><span>| `ChainIssuerSubjectMismatch</span> of <a href="../../X509/Certificate/index.html#type-t">X509.Certificate.t</a> * <a href="../../X509/Certificate/index.html#type-t">X509.Certificate.t</a></span> <span>| `EmptyCertificateChain</span> <span><span>| `IntermediateCertificateExpired</span> of <a href="../../X509/Certificate/index.html#type-t">X509.Certificate.t</a> * <span>Ptime.t option</span></span> <span><span>| `IntermediateInvalidExtensions</span> of <a href="../../X509/Certificate/index.html#type-t">X509.Certificate.t</a></span> <span><span>| `IntermediateInvalidVersion</span> of <a href="../../X509/Certificate/index.html#type-t">X509.Certificate.t</a></span> <span><span>| `NoTrustAnchor</span> of <a href="../../X509/Certificate/index.html#type-t">X509.Certificate.t</a></span> <span><span>| `Revoked</span> of <a href="../../X509/Certificate/index.html#type-t">X509.Certificate.t</a></span> ]</span></span> <span><span>| `Leaf</span> of <span>[&gt; <span>`LeafCertificateExpired of <a href="../../X509/Certificate/index.html#type-t">X509.Certificate.t</a> * <span>Ptime.t option</span></span> <span><span>| `LeafInvalidExtensions</span> of <a href="../../X509/Certificate/index.html#type-t">X509.Certificate.t</a></span> <span><span>| `LeafInvalidName</span> of <a href="../../X509/Certificate/index.html#type-t">X509.Certificate.t</a> * <span><span><span>[ `host ]</span> Domain_name.t</span> option</span></span> <span><span>| `LeafInvalidVersion</span> of <a href="../../X509/Certificate/index.html#type-t">X509.Certificate.t</a></span> ]</span></span> ]</span>)</span> Result.result</span></code></dt><dt class="spec value" id="val-any_m"><a href="#val-any_m" class="anchor"></a><code><span class="keyword">val</span> any_m : <span class="type-var">'a</span> <span>&#45;&gt;</span> <span>(<span class="type-var">'b</span> <span>&#45;&gt;</span> <span><span>(<span class="type-var">'c</span>,Â <span class="type-var">'d</span>)</span> Stdlib.result</span>)</span> <span>&#45;&gt;</span> <span><span class="type-var">'b</span> list</span> <span>&#45;&gt;</span> <span><span>(<span><span>(<span class="type-var">'b</span> * <span class="type-var">'c</span>)</span> option</span>,Â <span class="type-var">'a</span>)</span> Stdlib.result</span></code></dt><dt class="spec value" id="val-verify_chain_of_trust"><a href="#val-verify_chain_of_trust" class="anchor"></a><code><span class="keyword">val</span> verify_chain_of_trust : <span>?&#8288;host:<span><span>[ `host ]</span> Domain_name.t</span></span> <span>&#45;&gt;</span> <span>?&#8288;time:Ptime.t</span> <span>&#45;&gt;</span> <span>?&#8288;revoked:<span>(<span>issuer:<a href="../../X509/Certificate/index.html#type-t">X509.Certificate.t</a></span> <span>&#45;&gt;</span> <span>cert:<a href="../../X509/Certificate/index.html#type-t">X509.Certificate.t</a></span> <span>&#45;&gt;</span> bool)</span></span> <span>&#45;&gt;</span> <span>?&#8288;hash_whitelist:<span><span>[&gt; `MD5 <span>| `SHA1</span> <span>| `SHA224</span> <span>| `SHA256</span> <span>| `SHA384</span> <span>| `SHA512</span> ]</span> list</span></span> <span>&#45;&gt;</span> <span>anchors:<span><a href="../../X509/Certificate/index.html#type-t">X509.Certificate.t</a> list</span></span> <span>&#45;&gt;</span> <span><a href="../../X509/Certificate/index.html#type-t">X509.Certificate.t</a> list</span> <span>&#45;&gt;</span> <span><span>(<span><span>(<span><a href="../../X509/Certificate/index.html#type-t">X509.Certificate.t</a> list</span> * <a href="../../X509/Certificate/index.html#type-t">X509.Certificate.t</a>)</span> option</span>,Â <span>[&gt; `EmptyCertificateChain <span>| `InvalidChain</span> <span><span>| `Leaf</span> of <span>[&gt; <span>`LeafCertificateExpired of <a href="../../X509/Certificate/index.html#type-t">X509.Certificate.t</a> * <span>Ptime.t option</span></span> <span><span>| `LeafInvalidExtensions</span> of <a href="../../X509/Certificate/index.html#type-t">X509.Certificate.t</a></span> <span><span>| `LeafInvalidName</span> of <a href="../../X509/Certificate/index.html#type-t">X509.Certificate.t</a> * <span><span><span>[ `host ]</span> Domain_name.t</span> option</span></span> <span><span>| `LeafInvalidVersion</span> of <a href="../../X509/Certificate/index.html#type-t">X509.Certificate.t</a></span> ]</span></span> ]</span>)</span> Result.result</span></code></dt><dt class="spec value" id="val-valid_cas"><a href="#val-valid_cas" class="anchor"></a><code><span class="keyword">val</span> valid_cas : <span>?&#8288;hash_whitelist:<span><span>[&gt; `MD5 <span>| `SHA1</span> <span>| `SHA224</span> <span>| `SHA256</span> <span>| `SHA384</span> <span>| `SHA512</span> ]</span> list</span></span> <span>&#45;&gt;</span> <span>?&#8288;time:Ptime.t</span> <span>&#45;&gt;</span> <span><a href="../../X509/Certificate/index.html#type-t">X509.Certificate.t</a> list</span> <span>&#45;&gt;</span> <span><a href="../../X509/Certificate/index.html#type-t">X509.Certificate.t</a> list</span></code></dt><dt class="spec value" id="val-fingerprint_verification"><a href="#val-fingerprint_verification" class="anchor"></a><code><span class="keyword">val</span> fingerprint_verification : <span>?&#8288;host:<span><span>[ `host ]</span> Domain_name.t</span></span> <span>&#45;&gt;</span> <span>?&#8288;time:Ptime.t</span> <span>&#45;&gt;</span> <span><span>(<span><span>[ `host ]</span> Domain_name.t</span> * Cstruct.t)</span> list</span> <span>&#45;&gt;</span> <span>(<a href="../../X509/Certificate/index.html#type-t">X509.Certificate.t</a> <span>&#45;&gt;</span> Cstruct.t)</span> <span>&#45;&gt;</span> <span><a href="../../X509/Certificate/index.html#type-t">X509.Certificate.t</a> list</span> <span>&#45;&gt;</span> <span><span>(<span><span class="type-var">'a</span> option</span>,Â <span>[&gt; `EmptyCertificateChain <span><span>| `Fingerprint</span> of <span>[&gt; <span>`InvalidFingerprint of <a href="../../X509/Certificate/index.html#type-t">X509.Certificate.t</a> * Cstruct.t * Cstruct.t</span> <span><span>| `NameNotInList</span> of <a href="../../X509/Certificate/index.html#type-t">X509.Certificate.t</a></span> <span><span>| `ServerNameNotPresent</span> of <a href="../../X509/Certificate/index.html#type-t">X509.Certificate.t</a> * <span><span>[ `host ]</span> Domain_name.t</span></span> ]</span></span> <span><span>| `Leaf</span> of <span>[&gt; <span>`LeafCertificateExpired of <a href="../../X509/Certificate/index.html#type-t">X509.Certificate.t</a> * <span>Ptime.t option</span></span> <span><span>| `LeafInvalidName</span> of <a href="../../X509/Certificate/index.html#type-t">X509.Certificate.t</a> * <span><span><span>[ `host ]</span> Domain_name.t</span> option</span></span> ]</span></span> ]</span>)</span> Stdlib.result</span></code></dt><dt class="spec value" id="val-trust_key_fingerprint"><a href="#val-trust_key_fingerprint" class="anchor"></a><code><span class="keyword">val</span> trust_key_fingerprint : <span>?&#8288;host:<span><span>[ `host ]</span> Domain_name.t</span></span> <span>&#45;&gt;</span> <span>?&#8288;time:Ptime.t</span> <span>&#45;&gt;</span> <span>hash:<span>[&lt; Nocrypto.Hash.hash SHA256 ]</span></span> <span>&#45;&gt;</span> <span>fingerprints:<span><span>(<span><span>[ `host ]</span> Domain_name.t</span> * Cstruct.t)</span> list</span></span> <span>&#45;&gt;</span> <span><a href="../../X509/Certificate/index.html#type-t">X509.Certificate.t</a> list</span> <span>&#45;&gt;</span> <span><span>(<span><span class="type-var">'a</span> option</span>,Â <span>[&gt; `EmptyCertificateChain <span><span>| `Fingerprint</span> of <span>[&gt; <span>`InvalidFingerprint of <a href="../../X509/Certificate/index.html#type-t">X509.Certificate.t</a> * Cstruct.t * Cstruct.t</span> <span><span>| `NameNotInList</span> of <a href="../../X509/Certificate/index.html#type-t">X509.Certificate.t</a></span> <span><span>| `ServerNameNotPresent</span> of <a href="../../X509/Certificate/index.html#type-t">X509.Certificate.t</a> * <span><span>[ `host ]</span> Domain_name.t</span></span> ]</span></span> <span><span>| `Leaf</span> of <span>[&gt; <span>`LeafCertificateExpired of <a href="../../X509/Certificate/index.html#type-t">X509.Certificate.t</a> * <span>Ptime.t option</span></span> <span><span>| `LeafInvalidName</span> of <a href="../../X509/Certificate/index.html#type-t">X509.Certificate.t</a> * <span><span><span>[ `host ]</span> Domain_name.t</span> option</span></span> ]</span></span> ]</span>)</span> Stdlib.result</span></code></dt><dt class="spec value" id="val-trust_cert_fingerprint"><a href="#val-trust_cert_fingerprint" class="anchor"></a><code><span class="keyword">val</span> trust_cert_fingerprint : <span>?&#8288;host:<span><span>[ `host ]</span> Domain_name.t</span></span> <span>&#45;&gt;</span> <span>?&#8288;time:Ptime.t</span> <span>&#45;&gt;</span> <span>hash:<span>[&lt; Nocrypto.Hash.hash ]</span></span> <span>&#45;&gt;</span> <span>fingerprints:<span><span>(<span><span>[ `host ]</span> Domain_name.t</span> * Cstruct.t)</span> list</span></span> <span>&#45;&gt;</span> <span><a href="../../X509/Certificate/index.html#type-t">X509.Certificate.t</a> list</span> <span>&#45;&gt;</span> <span><span>(<span><span class="type-var">'a</span> option</span>,Â <span>[&gt; `EmptyCertificateChain <span><span>| `Fingerprint</span> of <span>[&gt; <span>`InvalidFingerprint of <a href="../../X509/Certificate/index.html#type-t">X509.Certificate.t</a> * Cstruct.t * Cstruct.t</span> <span><span>| `NameNotInList</span> of <a href="../../X509/Certificate/index.html#type-t">X509.Certificate.t</a></span> <span><span>| `ServerNameNotPresent</span> of <a href="../../X509/Certificate/index.html#type-t">X509.Certificate.t</a> * <span><span>[ `host ]</span> Domain_name.t</span></span> ]</span></span> <span><span>| `Leaf</span> of <span>[&gt; <span>`LeafCertificateExpired of <a href="../../X509/Certificate/index.html#type-t">X509.Certificate.t</a> * <span>Ptime.t option</span></span> <span><span>| `LeafInvalidName</span> of <a href="../../X509/Certificate/index.html#type-t">X509.Certificate.t</a> * <span><span><span>[ `host ]</span> Domain_name.t</span> option</span></span> ]</span></span> ]</span>)</span> Stdlib.result</span></code></dt></dl></div></body></html>